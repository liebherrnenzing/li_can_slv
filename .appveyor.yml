version: 1.0.0-{build}
os:
- Visual Studio 2015

cache:
- '%LOCALAPPDATA%\pip\Cache'

environment:
  COVERALLS_REPO_TOKEN:
    secure: FS/GYcjP49aCRYe8LHIw0oQsFI+PPc+CADIDid2C056z4BmkdPZaPL6PON3dAbIh
  matrix:
  - PYTHON_DIR: C:\Python37-x64
  
install:
  - SET PATH=%PYTHON_DIR%;%PYTHON_DIR%\Scripts;%PATH%
  - "python -m pip install --upgrade pip"
  - "pip install -r requirements.txt"
  - "pip install cpp-coveralls"
  
build_script:
- "inv configure"
- "inv all"

test_script:
- "inv test"
- "inv cov"

after_test:
- cd build
- coveralls --help
- coveralls --root .. -e ".*CMakeFiles.*" -e ".*/verify/.*" 

    